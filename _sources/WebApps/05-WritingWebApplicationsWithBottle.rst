Writing Web Applications With Bottle
------------------------------------

In this section, you will learn how to write web applications using a Python framework 
called Bottle.

Here is an example of a Bottle web application:

.. sourcecode:: python
   :linenos:
   
    import bottle
    from datetime import datetime

    @bottle.route('/')
    def hello():
        return """<html><body>
            <h1>Hello, world!</h1>
            The time is {0}.</body></html>""".format(
                str(datetime.now()))

    # Launch the BottlePy dev server 
    bottle.run(host='localhost', debug=True)


The application begins by importing the bottle framework on line 1. Lines 4-9 define a function ``hello()``
that serves up a simple web page containing the date and time. The call to ``bottle.run()`` on Line 12 
starts a small web server. The ``run()`` method
does not return; it executes an infinite loop that waits for incoming requests from web browsers.
When a web browser sends a request to the bottle web server, the server invokes the ``hello()`` function
and returns the HTML code generated by the function to the web browser, which displays the result.

To see this in action, copy the code above into a text editor and save it as bottlehello.py (or whatever
name you like). Then, download the Bottle framework and install it on your computer. In many cases,
you can accomplish this using the pip command included with your Python distribution::

    pip install bottle
    
If that doesn't work, you can download the Bottle framework from bottlepy.org. It consists
of a single Python script, bottle.py. Place that script in the same folder as your 
bottlehello.py program.

Next, execute your bottlehello.py program from the command line::

    python bottlehello.py
    
You should see a message similar to the following appear on the console::

    Bottle v0.12.9 server starting up (using WSGIRefServer())...
    Listening on http://localhost:8080/
    Hit Ctrl-C to quit.
    
    
.. note::    

    If you get an error message of some sort, it is possible that your computer
    may be running a server application that is using the port number that
    Bottle wants to use. See the next
    section, "More About Bottle," for a discussion of port numbers and how
    to address this issue.
    
Once the Bottle server is running, open a web browser and enter the following URL:

http://localhost:8080/
    
You should see a "Hello, world!" message appear:

.. image:: Figures/bottlehello.png

To send the request again, press the Reload button in your browser. You should
see the date and time change.

